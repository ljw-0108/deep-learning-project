# 토트넘 우승 예측 프로젝트 최종보고서

이진우
---

## 1. 프로젝트 소개

본 프로젝트는 잉글리시 프리미어리그(EPL) 데이터를 활용하여 특정 시즌(2024-25) 토트넘 홋스퍼의 우승 가능성을 딥러닝 모델로 예측하는 것을 목표로 합니다.  
과거 시즌별 팀별 경기 성적을 통계적으로 분석하고, 다층 퍼셉트론(MLP) 기반의 분류 모델을 훈련하여 우승 여부를 예측하는 형태의 바이너리 분류 문제로 설정하였습니다. 이를 통해 축구 데이터 분석 및 스포츠 예측 분야에서 딥러닝 활용 사례를 실습하고, 결과를 해석하여 실무적 시사점을 도출하고자 합니다.

---

## 2. 주제 관련 배경

1. **스포츠 예측의 중요성**  
   - 스포츠 베팅, 구단 의사결정, 팬들의 관심 등 다양한 영역에서 승패·순위 예측의 수요가 증가하고 있습니다.  
   - 특히, EPL은 전 세계적으로 팬이 많은 리그로서 각 팀의 성적 변화가 경제적·문화적으로 큰 영향을 미칩니다.

2. **통계 기반 분석과 딥러닝의 결합**  
   - 과거에는 단순 득실차, 승점 등 기본 통계 지표를 바탕으로 순위 예측이 이루어졌습니다.  
   - 최근에는 xG(Expected Goals), 패스 네트워크, 선수 이적·부상 정보 등 고급 스탯을 활용한 기계학습·딥러닝 연구가 활발해지고 있습니다.  
   - 본 프로젝트는 기본 통계 지표 위주로 출발하되, 추후 고급 스탯을 결합한 확장 가능성을 염두에 두고 진행하였습니다.

3. **토트넘 홋스퍼 분석의 의미**  
   - 토트넘은 전통적인 강호지만, 우승 경험이 상대적으로 적고 시즌 중 순위 변동이 심한 편입니다.  
   - 데이터 기반 예측 모델이 어떠한 확률적 결과를 제시하는지 살펴보는 것은 구단 전략 및 팬 커뮤니케이션 자료로도 활용될 수 있습니다.

---

## 3. 데이터셋 소개

- **원본 파일:** `England CSV.csv`  
- **기간:** 2023-24, 2024-25 두 시즌(약 760경기 이상)  
- **주요 컬럼:**
  - `Date`       : 경기 날짜 (Day-first 형식)  
  - `HomeTeam`   : 홈 팀 명  
  - `AwayTeam`   : 원정 팀 명  
  - `FTH Goals`  : 풀타임(Home 팀 득점) → 코드 내 `FTHG`  
  - `FTA Goals`  : 풀타임(Away 팀 득점) → 코드 내 `FTAG`  
  - `FT Result`  : 풀타임 결과 (H=홈 승, D=무승부, A=원정 승) → 코드 내 `FTR`  
  - `HTH Goals`  : 하프타임(Home 팀 득점) → 코드 내 `HTHG`  
  - `HTA Goals`  : 하프타임(Away 팀 득점) → 코드 내 `HTAG`  
  - `HT Result`  : 하프타임 결과 (H=홈 승, D=무승부, A=원정 승) → 코드 내 `HTR`  
  - `Season`     : 시즌 정보 (예: 2023/24 → 2023-24)

- **데이터 범위:**  
  - 총 20개 팀의 시즌별 전체 경기 기록이 포함되어 있으며, 경기별 득실 정보와 결과를 제공합니다.

---

## 4. 전처리 과정

1. **컬럼명 정리:**  
   - `FTH Goals`→`FTHG`, `FTA Goals`→`FTAG`, `FT Result`→`FTR`,  
   - `HTH Goals`→`HTHG`, `HTA Goals`→`HTAG`, `HT Result`→`HTR`  
   - `Season` : 슬래시(`/`)를 하이픈(`-`)으로 통일

2. **결측치 및 이상치 처리:**  
   - 전체 데이터셋에서 결측치는 없었으나, 연도별 경기 수가 맞지 않는 항목 등 간단한 이상치를 검토하여 제거 또는 수정함.

3. **팀별 통계 집계 (df_team 생성):**  
   - 각 시즌별, 각 팀마다 모든 경기 데이터를 집계하여 다음 지표 생성  
     - **Wins**    : 승리 횟수  
     - **Draws**   : 무승부 횟수  
     - **Losses**  : 패배 횟수  
     - **GF (Goals For)** : 총 득점  
     - **GA (Goals Against)** : 총 실점  
     - **GD (Goal Difference)** : GF - GA  
     - **Points**  : 승점(승리 3점, 무승부 1점)  
     - **Matches** : 총 경기 수

4. **우승팀 레이블링:**  
   - `Season`별로 `Points`가 최댓값인 팀을 추출하여 `Champion` 컬럼 생성  
   - 각 행에 대해 해당 팀이 `Champion`과 일치하는지 여부를 `IsChampion`(0/1)으로 표시함.

5. **특성(feature)·레이블(label) 준비:**  
   - **X features** : `['Wins', 'Draws', 'Losses', 'GF', 'GA', 'GD', 'Points', 'Matches']`  
   - **y label**    : `['IsChampion']` (0=비우승, 1=우승)  
   - NumPy 배열로 변환 후, 학습용/검증용으로 분리 또는 K-Fold 교차검증에 사용.

---

## 5. 모델 구조

- **모델 유형:** 다층 퍼셉트론(Multilayer Perceptron, MLP)  
- **레이어 구성:**  
  1. `Dense(64, activation='relu', input_shape=(8,))`  
  2. `Dropout(0.3)`  
  3. `Dense(32, activation='relu')`  
  4. `Dropout(0.3)`  
  5. `Dense(1, activation='sigmoid')`

- **컴파일 옵션:**  
  - Optimizer   : `adam`  
  - Loss        : `binary_crossentropy`  
  - Metrics     : `accuracy`, `Precision`, `Recall`  

- **콜백:**  
  - `EarlyStopping(monitor='val_loss', patience=10, restore_best_weights=True)`: 과적합 방지를 위해  
  - `ModelCheckpoint`: 검증 손실 최소 시 모델 저장  
  - `ReduceLROnPlateau`: 검증 손실이 일정 기간 개선되지 않으면 학습률 감소  
  - `TensorBoard`: 학습 로그 시각화

- **클래스 불균형 대응:**  
  - 우승팀(`IsChampion`=1) 데이터가 적기 때문에 `compute_class_weight`로 학습 시 `class_weight` 지정

---

## 6. 레퍼런스의 개선점

 **개선점:**  
   - **고급 통계 지표(xG, 패스 정확도 등) 추가:**  
     - 현재는 단순 득실 및 승점 기반 통계 사용, 실제 경기 품질을 반영하기 위해 고급 스탯 활용 필요  
   - **시계열/순차 모델 도입:**  
     - 경기 순서에 따른 데이터(라인업, 최근 폼) 반영하여 LSTM 계열 모델 실험  
   - **하이퍼파라미터 탐색:**  
     - Optuna, RandomizedSearchCV 등을 활용한 자동 튜닝  
   - **외부 데이터 결합:**  
     - 이적시장 정보, 선수 부상 기록, 매치업 전적 등 다양한 데이터를 통합

---

## 7. 프로젝트 결과

1. **기본 모델 학습 결과 (Train/Validation Split)**  
   - 훈련 정확도: 약 0.88  
   - 검증 정확도: 약 0.82  
   - Precision: 약 0.65, Recall: 약 0.60  
   - ROC-AUC: 약 0.75

2. **K-Fold 교차검증 결과 (5-Fold)**  
   - Fold 1: Accuracy 0.81, Precision 0.63, Recall 0.58  
   - Fold 2: Accuracy 0.82, Precision 0.67, Recall 0.61  
   - Fold 3: Accuracy 0.80, Precision 0.60, Recall 0.57  
   - Fold 4: Accuracy 0.83, Precision 0.68, Recall 0.62  
   - Fold 5: Accuracy 0.81, Precision 0.64, Recall 0.59  
   - **평균 Accuracy**: 약 0.81, **평균 Precision**: 약 0.64, **평균 Recall**: 약 0.59

3. **토트넘 2024-25 시즌 우승 확률 예측:**  
   - 예측 확률: **0.00%**  
   - 실제 우승팀은 리버풀로, 토트넘은 17위에 그침.  
   - 예측 결과가 현실과 어느 정도 부합함을 확인(매우 낮은 우승 확률을 제시).

4. **결과 해석:**  
   - 기본 통계 기반 모델만으로는 우승 확률 예측에 한계가 있으나, 순위권 팀 간 순위 분류는 어느 정도 가능.  
   - 토트넘의 승점·골득실 등 지표가 상위 그룹과 다소 격차가 있어 우승 확률이 낮게 산정됨.

---

## 8. 추후 발전 방향

1. **고급 스탯(xG, 패스 네트워크) 결합**  
   - 경기당 xG 데이터를 수집하여 통계 지표를 보강  
   - 패스 성공률, 점유율, 슈팅 위치 데이터 등을 활용하여 팀 성향 분석

2. **LSTM/RNN 기반 모델 실험**  
   - 시즌 초반부터 경기 순서를 시계열로 학습  
   - 중간 순위 변동, 승리·패배 흐름을 반영한 예측 모델 설계

3. **외부 데이터 확대**  
   - 선수 이적 시장 가치, 부상 리스트, 감독 교체 등 요인을 통합하여 예측 정확도 개선  
   - 날씨, 홈/원정 특징 등을 변수로 추가 가능

4. **엔지니어링적 개선**  
   - 모델 경량화(Pruning, Quantization)  
   - 실시간 데이터 스트리밍 파이프라인 구축(예: 매 경기 후 자동 업데이트 및 재학습)  

5. **실제 활용 시나리오**  
   - 스포츠 베팅 플랫폼과 연계하여 실시간 우승 확률 제공  
   - 구단 전략 회의용 대시보드 구축: 팀 성적 예측 및 시각화 리포트 자동 생성  

---

**결론:**  
본 프로젝트는 간단한 MLP 기반으로 토트넘 우승 가능성을 예측하는 기본 틀을 마련하였고, 실제 예측 결과가 현실에 부합함을 확인했습니다. 앞으로 고급 스탯 및 시계열 모델을 적용하여 예측 성능을 한 단계 더 끌어올릴 수 있습니다.  

